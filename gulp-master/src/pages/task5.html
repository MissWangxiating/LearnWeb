<!DOCTYPE html>
<html>
<head>
    <title>实现日历功能</title>
    <meta charset=utf-8>
    <meta name=description content="日历功能">
    <meta name=viewport content="width=device-width, initial-scale=1">
    <style type="text/css" media="screen">
        table,th,td {
            border:1px solid blue;
        }
        table {
            width: 600px;
            min-height:100px;
            line-height :50px;
            text-align: center;
            border-collapse: collapse;
        }
        .now_day{
            background-color:red;
        }

    </style>
</head>
<body>
    <!--下拉框选择年月-->
    <div>
        <!--选择年从2000年到2030年-->
        <select id="year" name="year" >
            <option value="2000">2000</option>
            <option value="2001">2001</option>
            <option value="2002">2002</option>
        </select>
        <span>年</span>
        <select name="month" >
            <option value="Jan">1</option>
            <option value="Feb">2</option>
            <option value="Mar">3</option>
            <option value="Apr">4</option>
            <option value="May">5</option>
            <option value="Jun">6</option>
            <option value="Jul">7</option>
            <option value="Aug">8</option>
            <option value="Sep">9</option>
            <option value="Oct">10</option>
            <option value="Nov">11</option>
            <option value="Dec">12</option>
        </select>
        <span>月</span>
    </div>
    <!--日历列表框-->
    <div>
        <table>
              <caption>2018年2月</caption>
              <thead>
                  <tr>
                      <th>星期日</th>
                      <th>星期一</th>
                      <th>星期二</th>
                      <th>星期三</th>
                      <th>星期四</th>
                      <th>星期五</th>
                      <th>星期六</th>
                  </tr>
              </thead>
              <tbody id="date_menu">
              </tbody>
          </table>


    </div>
    <script type="text/javascript">
        //创建选择的年份列表
        //获取下拉列表父节点
        var s_year = document.getElementById("year");
        s_year="";
        //想要用数组自动生成2000年至2030年的数，可是好像不行？
        for (var i = 0; i < 30; i++) {
            //创建子节点
            var option = document.createElement("option");
            option.setAttribute("value", 2000+i);
            option.innerHTML = 2000 + i ;
            s_year.appendChild(option);
                };

        var now = new Date();
        console.log(now);
        //获取年份
        var y = now.getFullYear();
        //获取月份
        var m = now.getMonth();
        //获取日
        var d = now.getDate();
        //获取星期
        var weekday = now.getDay();
        //console.log(y);
        //console.log(m);
        //console.log(d);
        //console.log(weekday);
        //判断当前年份是否为闰年，能被4整除，但是不能被100整除，或者能被400整除，返回1，否则返回0
        function isLeapYear (year){
            // body...
            if (year%100==0) {
                if (year%4==0) {
                    return 1;
                } else{
                    return 0;
                };

                    }
            else{
                if (year%4==0) {
                    return 1;
                } else{
                    return 0;
                };
            };
        }
        console.log(isLeapYear(y));
        //创建月份数组
        var days_per_month = new Array(31,28 + isLeapYear(y),31,30,31,30,31,31,30,31,30,31);
        //确定表格行数
        var firstday = new Date(y,m,1);
        var w_day = firstday.getDay();
        var tr_nums = Math.ceil((w_day + days_per_month[m])/7); //math.ceil函数是向上取整的函数
        //打印日历
        //获取tbody父节点
        var tbody = document.getElementById("date_menu");
        tbody.innerHTML="";
        //console.log(tbody);
        for (var i = 0; i < tr_nums; i++) {
            //创建tr子节点
            var tr = document.createElement("tr");
            for (var j = 0; j < 7; j++) {
                 var idx = 7*i + j;
                 var date = idx - w_day + 1;
                 if (date <= 0||date > days_per_month[m]) {
                    date = "&nbsp";
                 }
                 //document.write("<td>"+ date +"</td>");
                 //创建td子节点
                 var td =document.createElement("td");
                 if(date==d){
                    td.setAttribute("class","now_day");
                 }
                 td.innerHTML = date;
                 tr.appendChild(td);
                   };
                   tbody.appendChild(tr);
                 };



    </script>

</body>
</html>